{
    "componentChunkName": "component---src-templates-post-tsx",
    "path": "/2018-03-2-Founds/",
    "result": {"data":{"markdownRemark":{"html":"<h2 id=\"sctp_id2assoc---use-after-free-read\" style=\"position:relative;\"><a href=\"#sctp_id2assoc---use-after-free-read\" aria-label=\"sctp_id2assoc   use after free read permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>sctp_id2assoc - use after free Read</h2>\n<p>Found in LK v4.16.0-rc4. Maybe it could be useful :)</p>\n<h3 id=\"call-trace-dump\" style=\"position:relative;\"><a href=\"#call-trace-dump\" aria-label=\"call trace dump permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Call Trace (Dump)</h3>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token punctuation\">[</span>   <span class=\"token number\">50.782403</span><span class=\"token punctuation\">]</span> Call Trace<span class=\"token operator\">:</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.782662</span><span class=\"token punctuation\">]</span>  dump_stack<span class=\"token operator\">+</span><span class=\"token number\">0x10a</span><span class=\"token operator\">/</span><span class=\"token number\">0x1dd</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.783020</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> _atomic_dec_and_lock<span class=\"token operator\">+</span><span class=\"token number\">0x163</span><span class=\"token operator\">/</span><span class=\"token number\">0x163</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.783469</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> show_regs_print_info<span class=\"token operator\">+</span><span class=\"token number\">0x12</span><span class=\"token operator\">/</span><span class=\"token number\">0x12</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.783925</span><span class=\"token punctuation\">]</span>  print_address_description<span class=\"token operator\">+</span><span class=\"token number\">0x60</span><span class=\"token operator\">/</span><span class=\"token number\">0x224</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.784395</span><span class=\"token punctuation\">]</span>  kasan_report<span class=\"token operator\">+</span><span class=\"token number\">0x196</span><span class=\"token operator\">/</span><span class=\"token number\">0x2a0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.784758</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> sctp_id2assoc<span class=\"token operator\">+</span><span class=\"token number\">0x350</span><span class=\"token operator\">/</span><span class=\"token number\">0x370</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.785139</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> sctp_id2assoc<span class=\"token operator\">+</span><span class=\"token number\">0x350</span><span class=\"token operator\">/</span><span class=\"token number\">0x370</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.785497</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> sctp_wfree<span class=\"token operator\">+</span><span class=\"token number\">0x660</span><span class=\"token operator\">/</span><span class=\"token number\">0x660</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.785818</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> __might_fault<span class=\"token operator\">+</span><span class=\"token number\">0x177</span><span class=\"token operator\">/</span><span class=\"token number\">0x1b0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.786163</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> sctp_getsockopt<span class=\"token operator\">+</span><span class=\"token number\">0x402e</span><span class=\"token operator\">/</span><span class=\"token number\">0x721a</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.786555</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> _raw_spin_unlock_irq<span class=\"token operator\">+</span><span class=\"token number\">0x24</span><span class=\"token operator\">/</span><span class=\"token number\">0x40</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.786931</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> finish_task_switch<span class=\"token operator\">+</span><span class=\"token number\">0x1c2</span><span class=\"token operator\">/</span><span class=\"token number\">0x740</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.787304</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> finish_task_switch<span class=\"token operator\">+</span><span class=\"token number\">0x182</span><span class=\"token operator\">/</span><span class=\"token number\">0x740</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.787683</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> sctp_getsockopt_peeloff_common<span class=\"token operator\">+</span><span class=\"token number\">0x350</span><span class=\"token operator\">/</span><span class=\"token number\">0x350</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.788143</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> lock_repin_lock<span class=\"token operator\">+</span><span class=\"token number\">0x410</span><span class=\"token operator\">/</span><span class=\"token number\">0x410</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.788503</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> __schedule<span class=\"token operator\">+</span><span class=\"token number\">0x752</span><span class=\"token operator\">/</span><span class=\"token number\">0x1ce0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.788835</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> select_task_rq_fair<span class=\"token operator\">+</span><span class=\"token number\">0x1196</span><span class=\"token operator\">/</span><span class=\"token number\">0x35d0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.789231</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> print_usage_bug<span class=\"token operator\">+</span><span class=\"token number\">0x140</span><span class=\"token operator\">/</span><span class=\"token number\">0x140</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.789616</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> save_trace<span class=\"token operator\">+</span><span class=\"token number\">0x300</span><span class=\"token operator\">/</span><span class=\"token number\">0x300</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.789946</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> active_load_balance_cpu_stop<span class=\"token operator\">+</span><span class=\"token number\">0xfb0</span><span class=\"token operator\">/</span><span class=\"token number\">0xfb0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.790429</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> put_prev_task_fair<span class=\"token operator\">+</span><span class=\"token number\">0x70</span><span class=\"token operator\">/</span><span class=\"token number\">0x70</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.790812</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> find_held_lock<span class=\"token operator\">+</span><span class=\"token number\">0x32</span><span class=\"token operator\">/</span><span class=\"token number\">0x1b0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.791165</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> schedule<span class=\"token operator\">+</span><span class=\"token number\">0xf0</span><span class=\"token operator\">/</span><span class=\"token number\">0x3a0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.791484</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> __schedule<span class=\"token operator\">+</span><span class=\"token number\">0x1ce0</span><span class=\"token operator\">/</span><span class=\"token number\">0x1ce0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.791842</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> __lock_acquire<span class=\"token operator\">+</span><span class=\"token number\">0x911</span><span class=\"token operator\">/</span><span class=\"token number\">0x4670</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.792223</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> rcu_note_context_switch<span class=\"token operator\">+</span><span class=\"token number\">0x710</span><span class=\"token operator\">/</span><span class=\"token number\">0x710</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.792656</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> futex_wait_setup<span class=\"token operator\">+</span><span class=\"token number\">0x128</span><span class=\"token operator\">/</span><span class=\"token number\">0x380</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.793053</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> debug_check_no_locks_freed<span class=\"token operator\">+</span><span class=\"token number\">0x210</span><span class=\"token operator\">/</span><span class=\"token number\">0x210</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.793526</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> get_futex_value_locked<span class=\"token operator\">+</span><span class=\"token number\">0xc0</span><span class=\"token operator\">/</span><span class=\"token number\">0xf0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.793947</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> futex_wait_setup<span class=\"token operator\">+</span><span class=\"token number\">0x1f9</span><span class=\"token operator\">/</span><span class=\"token number\">0x380</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.794343</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> find_held_lock<span class=\"token operator\">+</span><span class=\"token number\">0x32</span><span class=\"token operator\">/</span><span class=\"token number\">0x1b0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.794686</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> futex_wake<span class=\"token operator\">+</span><span class=\"token number\">0x630</span><span class=\"token operator\">/</span><span class=\"token number\">0x630</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.795016</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> futex_wake<span class=\"token operator\">+</span><span class=\"token number\">0x528</span><span class=\"token operator\">/</span><span class=\"token number\">0x630</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.795343</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> drop_futex_key_refs<span class=\"token punctuation\">.</span>isra<span class=\"token punctuation\">.</span><span class=\"token number\">13</span><span class=\"token operator\">+</span><span class=\"token number\">0x51</span><span class=\"token operator\">/</span><span class=\"token number\">0xa0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.795778</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> futex_wait<span class=\"token operator\">+</span><span class=\"token number\">0x637</span><span class=\"token operator\">/</span><span class=\"token number\">0x930</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.796132</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> futex_wait_setup<span class=\"token operator\">+</span><span class=\"token number\">0x380</span><span class=\"token operator\">/</span><span class=\"token number\">0x380</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.796521</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> mark_wake_futex<span class=\"token operator\">+</span><span class=\"token number\">0xba</span><span class=\"token operator\">/</span><span class=\"token number\">0x1d0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.796877</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> wake_up_q<span class=\"token operator\">+</span><span class=\"token number\">0x97</span><span class=\"token operator\">/</span><span class=\"token number\">0xe0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.797177</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> drop_futex_key_refs<span class=\"token punctuation\">.</span>isra<span class=\"token punctuation\">.</span><span class=\"token number\">13</span><span class=\"token operator\">+</span><span class=\"token number\">0x51</span><span class=\"token operator\">/</span><span class=\"token number\">0xa0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.797621</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> futex_wake<span class=\"token operator\">+</span><span class=\"token number\">0x2ac</span><span class=\"token operator\">/</span><span class=\"token number\">0x630</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.797952</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> save_trace<span class=\"token operator\">+</span><span class=\"token number\">0x300</span><span class=\"token operator\">/</span><span class=\"token number\">0x300</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.798270</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> lock_acquire<span class=\"token operator\">+</span><span class=\"token number\">0x4a0</span><span class=\"token operator\">/</span><span class=\"token number\">0x4a0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.798624</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> finish_task_switch<span class=\"token operator\">+</span><span class=\"token number\">0x182</span><span class=\"token operator\">/</span><span class=\"token number\">0x740</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.799014</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> do_futex<span class=\"token operator\">+</span><span class=\"token number\">0x7da</span><span class=\"token operator\">/</span><span class=\"token number\">0x1f50</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.799341</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> find_held_lock<span class=\"token operator\">+</span><span class=\"token number\">0x32</span><span class=\"token operator\">/</span><span class=\"token number\">0x1b0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.799683</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> lock_acquire<span class=\"token operator\">+</span><span class=\"token number\">0x4a0</span><span class=\"token operator\">/</span><span class=\"token number\">0x4a0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.800017</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> lock_downgrade<span class=\"token operator\">+</span><span class=\"token number\">0x6e0</span><span class=\"token operator\">/</span><span class=\"token number\">0x6e0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.800365</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> set_load_weight<span class=\"token operator\">+</span><span class=\"token number\">0x270</span><span class=\"token operator\">/</span><span class=\"token number\">0x270</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.800730</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> rcutorture_record_progress<span class=\"token operator\">+</span><span class=\"token number\">0x10</span><span class=\"token operator\">/</span><span class=\"token number\">0x10</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.801179</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> __fget<span class=\"token operator\">+</span><span class=\"token number\">0x386</span><span class=\"token operator\">/</span><span class=\"token number\">0x5b0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.801496</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> iterate_fd<span class=\"token operator\">+</span><span class=\"token number\">0x3d0</span><span class=\"token operator\">/</span><span class=\"token number\">0x3d0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.801837</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> find_held_lock<span class=\"token operator\">+</span><span class=\"token number\">0x32</span><span class=\"token operator\">/</span><span class=\"token number\">0x1b0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.802181</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> release_sock<span class=\"token operator\">+</span><span class=\"token number\">0x1d0</span><span class=\"token operator\">/</span><span class=\"token number\">0x280</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.802537</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> lock_acquire<span class=\"token operator\">+</span><span class=\"token number\">0x4a0</span><span class=\"token operator\">/</span><span class=\"token number\">0x4a0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.802897</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> __fget_light<span class=\"token operator\">+</span><span class=\"token number\">0x28c</span><span class=\"token operator\">/</span><span class=\"token number\">0x3a0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.803230</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> rcutorture_record_progress<span class=\"token operator\">+</span><span class=\"token number\">0x10</span><span class=\"token operator\">/</span><span class=\"token number\">0x10</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.803648</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> sock_has_perm<span class=\"token operator\">+</span><span class=\"token number\">0x26e</span><span class=\"token operator\">/</span><span class=\"token number\">0x360</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.804023</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> selinux_secmark_relabel_packet<span class=\"token operator\">+</span><span class=\"token number\">0xc0</span><span class=\"token operator\">/</span><span class=\"token number\">0xc0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.804535</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> schedule<span class=\"token operator\">+</span><span class=\"token number\">0xf0</span><span class=\"token operator\">/</span><span class=\"token number\">0x3a0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.804953</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> __release_sock<span class=\"token operator\">+</span><span class=\"token number\">0x350</span><span class=\"token operator\">/</span><span class=\"token number\">0x350</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.805394</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> mark_held_locks<span class=\"token operator\">+</span><span class=\"token number\">0xa8</span><span class=\"token operator\">/</span><span class=\"token number\">0xf0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.805837</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> SyS_getsockopt<span class=\"token operator\">+</span><span class=\"token number\">0x153</span><span class=\"token operator\">/</span><span class=\"token number\">0x310</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.806279</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> SyS_getsockopt<span class=\"token operator\">+</span><span class=\"token number\">0x153</span><span class=\"token operator\">/</span><span class=\"token number\">0x310</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.806732</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> SyS_setsockopt<span class=\"token operator\">+</span><span class=\"token number\">0x340</span><span class=\"token operator\">/</span><span class=\"token number\">0x340</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.807173</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> exit_to_usermode_loop<span class=\"token operator\">+</span><span class=\"token number\">0x181</span><span class=\"token operator\">/</span><span class=\"token number\">0x1e0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.807670</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> syscall_slow_exit_work<span class=\"token operator\">+</span><span class=\"token number\">0x400</span><span class=\"token operator\">/</span><span class=\"token number\">0x400</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.808058</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> do_syscall_64<span class=\"token operator\">+</span><span class=\"token number\">0xb0</span><span class=\"token operator\">/</span><span class=\"token number\">0x7a0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.808359</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> SyS_setsockopt<span class=\"token operator\">+</span><span class=\"token number\">0x340</span><span class=\"token operator\">/</span><span class=\"token number\">0x340</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.808692</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> do_syscall_64<span class=\"token operator\">+</span><span class=\"token number\">0x23e</span><span class=\"token operator\">/</span><span class=\"token number\">0x7a0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.809007</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> _raw_spin_unlock_irq<span class=\"token operator\">+</span><span class=\"token number\">0x24</span><span class=\"token operator\">/</span><span class=\"token number\">0x40</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.809350</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> finish_task_switch<span class=\"token operator\">+</span><span class=\"token number\">0x1c2</span><span class=\"token operator\">/</span><span class=\"token number\">0x740</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.809726</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> syscall_return_slowpath<span class=\"token operator\">+</span><span class=\"token number\">0x470</span><span class=\"token operator\">/</span><span class=\"token number\">0x470</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.810106</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> syscall_return_slowpath<span class=\"token operator\">+</span><span class=\"token number\">0x2df</span><span class=\"token operator\">/</span><span class=\"token number\">0x470</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.810480</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> prepare_exit_to_usermode<span class=\"token operator\">+</span><span class=\"token number\">0x330</span><span class=\"token operator\">/</span><span class=\"token number\">0x330</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.810876</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> entry_SYSCALL_64_after_hwframe<span class=\"token operator\">+</span><span class=\"token number\">0x52</span><span class=\"token operator\">/</span><span class=\"token number\">0xb7</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.811284</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> trace_hardirqs_off_thunk<span class=\"token operator\">+</span><span class=\"token number\">0x1a</span><span class=\"token operator\">/</span><span class=\"token number\">0x1c</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.811666</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> entry_SYSCALL_64_after_hwframe<span class=\"token operator\">+</span><span class=\"token number\">0x42</span><span class=\"token operator\">/</span><span class=\"token number\">0xb7</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.812079</span><span class=\"token punctuation\">]</span> \r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.812206</span><span class=\"token punctuation\">]</span> Allocated by task <span class=\"token number\">11561</span><span class=\"token operator\">:</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.812505</span><span class=\"token punctuation\">]</span>  kasan_kmalloc<span class=\"token operator\">+</span><span class=\"token number\">0xbf</span><span class=\"token operator\">/</span><span class=\"token number\">0xe0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.812798</span><span class=\"token punctuation\">]</span>  kmem_cache_alloc_trace<span class=\"token operator\">+</span><span class=\"token number\">0x142</span><span class=\"token operator\">/</span><span class=\"token number\">0x2f0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.813150</span><span class=\"token punctuation\">]</span>  sctp_association_new<span class=\"token operator\">+</span><span class=\"token number\">0x10e</span><span class=\"token operator\">/</span><span class=\"token number\">0x2060</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.813525</span><span class=\"token punctuation\">]</span>  __sctp_connect<span class=\"token operator\">+</span><span class=\"token number\">0x5a3</span><span class=\"token operator\">/</span><span class=\"token number\">0xc20</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.813827</span><span class=\"token punctuation\">]</span>  __sctp_setsockopt_connectx<span class=\"token operator\">+</span><span class=\"token number\">0x61</span><span class=\"token operator\">/</span><span class=\"token number\">0xc0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.814355</span><span class=\"token punctuation\">]</span>  sctp_getsockopt<span class=\"token operator\">+</span><span class=\"token number\">0x163d</span><span class=\"token operator\">/</span><span class=\"token number\">0x721a</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.814760</span><span class=\"token punctuation\">]</span> \r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.814920</span><span class=\"token punctuation\">]</span> Freed by task <span class=\"token number\">11551</span><span class=\"token operator\">:</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.815252</span><span class=\"token punctuation\">]</span>  __kasan_slab_free<span class=\"token operator\">+</span><span class=\"token number\">0x12c</span><span class=\"token operator\">/</span><span class=\"token number\">0x170</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.815655</span><span class=\"token punctuation\">]</span>  kfree<span class=\"token operator\">+</span><span class=\"token number\">0xf3</span><span class=\"token operator\">/</span><span class=\"token number\">0x2e0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.815953</span><span class=\"token punctuation\">]</span>  sctp_association_put<span class=\"token operator\">+</span><span class=\"token number\">0x20b</span><span class=\"token operator\">/</span><span class=\"token number\">0x300</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.816385</span><span class=\"token punctuation\">]</span>  sctp_association_free<span class=\"token operator\">+</span><span class=\"token number\">0x631</span><span class=\"token operator\">/</span><span class=\"token number\">0x880</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.816831</span><span class=\"token punctuation\">]</span>  sctp_do_sm<span class=\"token operator\">+</span><span class=\"token number\">0x2b04</span><span class=\"token operator\">/</span><span class=\"token number\">0x65d0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.817198</span><span class=\"token punctuation\">]</span> \r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.817359</span><span class=\"token punctuation\">]</span> The buggy address belongs to the object at ffff88007d62b300\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.817359</span><span class=\"token punctuation\">]</span>  which belongs to the cache kmalloc<span class=\"token operator\">-</span><span class=\"token number\">4096</span> of size <span class=\"token number\">4096</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.818653</span><span class=\"token punctuation\">]</span> The buggy address is located <span class=\"token number\">32</span> bytes inside of\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.818653</span><span class=\"token punctuation\">]</span>  <span class=\"token number\">4096</span><span class=\"token operator\">-</span>byte region <span class=\"token punctuation\">[</span>ffff88007d62b300<span class=\"token punctuation\">,</span> ffff88007d62c300<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.819783</span><span class=\"token punctuation\">]</span> The buggy address belongs to the page<span class=\"token operator\">:</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.820258</span><span class=\"token punctuation\">]</span> page<span class=\"token operator\">:</span>ffffea0001f58a00 count<span class=\"token operator\">:</span><span class=\"token number\">1</span> mapcount<span class=\"token operator\">:</span><span class=\"token number\">0</span> mapping<span class=\"token operator\">:</span><span class=\"token number\">0000000000000000</span> index<span class=\"token operator\">:</span><span class=\"token number\">0x0</span> compound_mapcount<span class=\"token operator\">:</span> <span class=\"token number\">0</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.821216</span><span class=\"token punctuation\">]</span> flags<span class=\"token operator\">:</span> <span class=\"token number\">0x500000000008100</span><span class=\"token punctuation\">(</span>slab<span class=\"token operator\">|</span>head<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.821660</span><span class=\"token punctuation\">]</span> raw<span class=\"token operator\">:</span> <span class=\"token number\">0500000000008100</span> <span class=\"token number\">0000000000000000</span> <span class=\"token number\">0000000000000000</span> <span class=\"token number\">0000000180070007</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.822410</span><span class=\"token punctuation\">]</span> raw<span class=\"token operator\">:</span> <span class=\"token number\">0000000000000000</span> <span class=\"token number\">0000000100000001</span> ffff88002dc02c00 <span class=\"token number\">0000000000000000</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.823160</span><span class=\"token punctuation\">]</span> page dumped because<span class=\"token operator\">:</span> kasan<span class=\"token operator\">:</span> bad access detected\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.823701</span><span class=\"token punctuation\">]</span> \r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.823860</span><span class=\"token punctuation\">]</span> Memory state around the buggy address<span class=\"token operator\">:</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.824350</span><span class=\"token punctuation\">]</span>  ffff88007d62b200<span class=\"token operator\">:</span> fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.825062</span><span class=\"token punctuation\">]</span>  ffff88007d62b280<span class=\"token operator\">:</span> fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.825733</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">></span>ffff88007d62b300<span class=\"token operator\">:</span> fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.826388</span><span class=\"token punctuation\">]</span>                                <span class=\"token operator\">^</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.826776</span><span class=\"token punctuation\">]</span>  ffff88007d62b380<span class=\"token operator\">:</span> fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.827424</span><span class=\"token punctuation\">]</span>  ffff88007d62b400<span class=\"token operator\">:</span> fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.828079</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.828719</span><span class=\"token punctuation\">]</span> Disabling lock debugging due to kernel taint\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.829292</span><span class=\"token punctuation\">]</span> Kernel panic <span class=\"token operator\">-</span> not syncing<span class=\"token operator\">:</span> panic_on_warn set <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.829292</span><span class=\"token punctuation\">]</span> \r\n<span class=\"token punctuation\">[</span>   <span class=\"token number\">50.830148</span><span class=\"token punctuation\">]</span> CPU<span class=\"token operator\">:</span> <span class=\"token number\">1</span> PID<span class=\"token operator\">:</span> <span class=\"token number\">11561</span> Comm<span class=\"token operator\">:</span> rs<span class=\"token operator\">:</span>main Q<span class=\"token operator\">:</span>Reg Tainted<span class=\"token operator\">:</span> G    B            <span class=\"token number\">4.16</span><span class=\"token number\">.0</span><span class=\"token operator\">-</span>rc4<span class=\"token operator\">+</span> #<span class=\"token number\">9</span></code></pre></div>\n<p><strong>End</strong></p>\n<h2 id=\"init_tty---kernel-panic\" style=\"position:relative;\"><a href=\"#init_tty---kernel-panic\" aria-label=\"init_tty   kernel panic permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>init_tty - kernel panic</h2>\n<p>Got from syzkaller &#x26; Found in <em>LK v4.16.0-rc5</em> with enabling <code class=\"language-text\">CONFIG_FAULT_INJECTION</code>.</p>\n<h3 id=\"call-trace-dump-1\" style=\"position:relative;\"><a href=\"#call-trace-dump-1\" aria-label=\"call trace dump 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Call Trace (Dump)</h3>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token punctuation\">[</span> <span class=\"token number\">2785.690162</span><span class=\"token punctuation\">]</span> Kernel panic <span class=\"token operator\">-</span> not syncing<span class=\"token operator\">:</span> n_tty<span class=\"token operator\">:</span> init_tty\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.690762</span><span class=\"token punctuation\">]</span> CPU<span class=\"token operator\">:</span> <span class=\"token number\">0</span> PID<span class=\"token operator\">:</span> <span class=\"token number\">29293</span> Comm<span class=\"token operator\">:</span> syz<span class=\"token operator\">-</span>executor4 Not tainted <span class=\"token number\">4.16</span><span class=\"token number\">.0</span><span class=\"token operator\">-</span>rc5<span class=\"token operator\">+</span> #<span class=\"token number\">12</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.691616</span><span class=\"token punctuation\">]</span> Hardware name<span class=\"token operator\">:</span> QEMU Standard <span class=\"token function\">PC</span> <span class=\"token punctuation\">(</span>i440FX <span class=\"token operator\">+</span> PIIX<span class=\"token punctuation\">,</span> <span class=\"token number\">1996</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> BIOS <span class=\"token number\">1.10</span><span class=\"token number\">.2</span><span class=\"token operator\">-</span><span class=\"token number\">1u</span>buntu1 <span class=\"token number\">04</span><span class=\"token operator\">/</span><span class=\"token number\">01</span><span class=\"token operator\">/</span><span class=\"token number\">2014</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.692623</span><span class=\"token punctuation\">]</span> Call Trace<span class=\"token operator\">:</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.692919</span><span class=\"token punctuation\">]</span>  dump_stack<span class=\"token operator\">+</span><span class=\"token number\">0xb9</span><span class=\"token operator\">/</span><span class=\"token number\">0x11b</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.693317</span><span class=\"token punctuation\">]</span>  panic<span class=\"token operator\">+</span><span class=\"token number\">0x10a</span><span class=\"token operator\">/</span><span class=\"token number\">0x2d6</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.693684</span><span class=\"token punctuation\">]</span>  tty_ldisc_init<span class=\"token punctuation\">.</span>cold<span class=\"token punctuation\">.</span><span class=\"token number\">6</span><span class=\"token operator\">+</span><span class=\"token number\">0x11</span><span class=\"token operator\">/</span><span class=\"token number\">0x1a</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.694182</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> alloc_tty_struct<span class=\"token operator\">+</span><span class=\"token number\">0x61</span><span class=\"token operator\">/</span><span class=\"token number\">0x2c0</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.694702</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> tty_init_dev<span class=\"token operator\">+</span><span class=\"token number\">0x4c</span><span class=\"token operator\">/</span><span class=\"token number\">0x210</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.695153</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> ptmx_open<span class=\"token operator\">+</span><span class=\"token number\">0xd2</span><span class=\"token operator\">/</span><span class=\"token number\">0x1c0</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.695566</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> pty_resize<span class=\"token operator\">+</span><span class=\"token number\">0xf0</span><span class=\"token operator\">/</span><span class=\"token number\">0xf0</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.695981</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> chrdev_open<span class=\"token operator\">+</span><span class=\"token number\">0xe2</span><span class=\"token operator\">/</span><span class=\"token number\">0x270</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.696414</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> cdev_put<span class=\"token punctuation\">.</span>part<span class=\"token punctuation\">.</span><span class=\"token number\">0</span><span class=\"token operator\">+</span><span class=\"token number\">0x20</span><span class=\"token operator\">/</span><span class=\"token number\">0x20</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.696870</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> do_dentry_open<span class=\"token operator\">+</span><span class=\"token number\">0x27a</span><span class=\"token operator\">/</span><span class=\"token number\">0x420</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.697357</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> vfs_open<span class=\"token operator\">+</span><span class=\"token number\">0x70</span><span class=\"token operator\">/</span><span class=\"token number\">0xb0</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.697747</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> path_openat<span class=\"token operator\">+</span><span class=\"token number\">0x2a0</span><span class=\"token operator\">/</span><span class=\"token number\">0x1060</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.698198</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> do_filp_open<span class=\"token operator\">+</span><span class=\"token number\">0xac</span><span class=\"token operator\">/</span><span class=\"token number\">0x130</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.698659</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> __alloc_fd<span class=\"token operator\">+</span><span class=\"token number\">0x200</span><span class=\"token operator\">/</span><span class=\"token number\">0x230</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.699089</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> _raw_spin_unlock<span class=\"token operator\">+</span><span class=\"token number\">0x1f</span><span class=\"token operator\">/</span><span class=\"token number\">0x30</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.699562</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> do_sys_open<span class=\"token operator\">+</span><span class=\"token number\">0x2b1</span><span class=\"token operator\">/</span><span class=\"token number\">0x350</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.700002</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> do_syscall_64<span class=\"token operator\">+</span><span class=\"token number\">0x73</span><span class=\"token operator\">/</span><span class=\"token number\">0x1f0</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.700451</span><span class=\"token punctuation\">]</span>  <span class=\"token operator\">?</span> entry_SYSCALL_64_after_hwframe<span class=\"token operator\">+</span><span class=\"token number\">0x42</span><span class=\"token operator\">/</span><span class=\"token number\">0xb7</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.701306</span><span class=\"token punctuation\">]</span> Dumping ftrace buffer<span class=\"token operator\">:</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.701807</span><span class=\"token punctuation\">]</span>    <span class=\"token punctuation\">(</span>ftrace buffer empty<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.702234</span><span class=\"token punctuation\">]</span> Kernel Offset<span class=\"token operator\">:</span> <span class=\"token number\">0x30e00000</span> from <span class=\"token number\">0xffffffff81000000</span> <span class=\"token punctuation\">(</span>relocation range<span class=\"token operator\">:</span> <span class=\"token number\">0xffffffff80000000</span><span class=\"token operator\">-</span><span class=\"token number\">0xffffffffbfffffff</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">[</span> <span class=\"token number\">2785.703442</span><span class=\"token punctuation\">]</span> Rebooting in <span class=\"token number\">86400</span> seconds<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></code></pre></div>\n<h3 id=\"poc\" style=\"position:relative;\"><a href=\"#poc\" aria-label=\"poc permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PoC</h3>\n<p>Reproducible code generated by syz-repro.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">_GNU_SOURCE</span> </span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;endian.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sys/syscall.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;unistd.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;errno.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;fcntl.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdarg.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdbool.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sys/stat.h></span></span>\r\n\r\n<span class=\"token keyword\">__attribute__</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>noreturn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">doexit</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> status<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n\t<span class=\"token keyword\">volatile</span> <span class=\"token keyword\">unsigned</span> i<span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">syscall</span><span class=\"token punctuation\">(</span>__NR_exit_group<span class=\"token punctuation\">,</span> status<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n\t<span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdint.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;string.h></span></span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token keyword\">int</span> kFailStatus <span class=\"token operator\">=</span> <span class=\"token number\">67</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token keyword\">int</span> kRetryStatus <span class=\"token operator\">=</span> <span class=\"token number\">69</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">exitf</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> msg<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n\t<span class=\"token keyword\">int</span> e <span class=\"token operator\">=</span> errno<span class=\"token punctuation\">;</span>\r\n\tva_list args<span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">va_start</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">,</span> msg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">vfprintf</span><span class=\"token punctuation\">(</span><span class=\"token constant\">stderr</span><span class=\"token punctuation\">,</span> msg<span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">va_end</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">fprintf</span><span class=\"token punctuation\">(</span><span class=\"token constant\">stderr</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\" (errno %d)\\n\"</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">doexit</span><span class=\"token punctuation\">(</span>kRetryStatus<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">static</span> bool <span class=\"token function\">write_file</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> file<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> what<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n\t<span class=\"token keyword\">char</span> buf<span class=\"token punctuation\">[</span><span class=\"token number\">1024</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\tva_list args<span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">va_start</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">,</span> what<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">vsnprintf</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> what<span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">va_end</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\tbuf<span class=\"token punctuation\">[</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">int</span> len <span class=\"token operator\">=</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n\t<span class=\"token keyword\">int</span> fd <span class=\"token operator\">=</span> <span class=\"token function\">open</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">,</span> O_WRONLY <span class=\"token operator\">|</span> O_CLOEXEC<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>fd <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\r\n\t\t<span class=\"token keyword\">return</span> false<span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>fd<span class=\"token punctuation\">,</span> buf<span class=\"token punctuation\">,</span> len<span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> len<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n\t\t<span class=\"token function\">close</span><span class=\"token punctuation\">(</span>fd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t\t<span class=\"token keyword\">return</span> false<span class=\"token punctuation\">;</span>\r\n\t<span class=\"token punctuation\">}</span>\r\n\t<span class=\"token function\">close</span><span class=\"token punctuation\">(</span>fd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">return</span> true<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">static</span> <span class=\"token keyword\">int</span> <span class=\"token function\">inject_fault</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> nth<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n\t<span class=\"token keyword\">int</span> fd<span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">char</span> buf<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n\tfd <span class=\"token operator\">=</span> <span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/proc/thread-self/fail-nth\"</span><span class=\"token punctuation\">,</span> O_RDWR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>fd <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\r\n\t\t<span class=\"token function\">exitf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"failed to open /proc/thread-self/fail-nth\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">,</span> <span class=\"token string\">\"%d\"</span><span class=\"token punctuation\">,</span> nth <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>fd<span class=\"token punctuation\">,</span> buf<span class=\"token punctuation\">,</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">ssize_t</span><span class=\"token punctuation\">)</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\t\t<span class=\"token function\">exitf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"failed to write /proc/thread-self/fail-nth\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">return</span> fd<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">loop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x20000200</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">syscall</span><span class=\"token punctuation\">(</span>__NR_set_mempolicy<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x20000200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">memcpy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">void</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x20000040</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"/dev/ptmx\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">write_file</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/sys/kernel/debug/failslab/ignore-gfp-wait\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"N\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">write_file</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/sys/kernel/debug/fail_futex/ignore-private\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"N\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">inject_fault</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">syscall</span><span class=\"token punctuation\">(</span>__NR_openat<span class=\"token punctuation\">,</span> <span class=\"token number\">0xffffffffffffff9c</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x20000040</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n\t<span class=\"token function\">syscall</span><span class=\"token punctuation\">(</span>__NR_mmap<span class=\"token punctuation\">,</span> <span class=\"token number\">0x20000000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1000000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x32</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">loop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>End</strong></p>\n<h2 id=\"tracepoint_probe_register_prio---warn\" style=\"position:relative;\"><a href=\"#tracepoint_probe_register_prio---warn\" aria-label=\"tracepoint_probe_register_prio   warn permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>tracepoint_probe_register_prio - warn</h2>\n<p>Got from syzkaller &#x26; Found in <em>LK v4.16.0-rc5</em> with enabling <code class=\"language-text\">CONFIG_FAULT_INJECTION</code>.</p>\n<h3 id=\"call-trace-dump-2\" style=\"position:relative;\"><a href=\"#call-trace-dump-2\" aria-label=\"call trace dump 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Call Trace (Dump)</h3>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">WARNING<span class=\"token operator\">:</span> CPU<span class=\"token operator\">:</span> <span class=\"token number\">1</span> PID<span class=\"token operator\">:</span> <span class=\"token number\">19167</span> at kernel<span class=\"token operator\">/</span>tracepoint<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">210</span> tracepoint_add_func kernel<span class=\"token operator\">/</span>tracepoint<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">210</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">inline</span><span class=\"token punctuation\">]</span>\r\nWARNING<span class=\"token operator\">:</span> CPU<span class=\"token operator\">:</span> <span class=\"token number\">1</span> PID<span class=\"token operator\">:</span> <span class=\"token number\">19167</span> at kernel<span class=\"token operator\">/</span>tracepoint<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">210</span> tracepoint_probe_register_prio<span class=\"token operator\">+</span><span class=\"token number\">0x11b</span><span class=\"token operator\">/</span><span class=\"token number\">0x3a0</span> kernel<span class=\"token operator\">/</span>tracepoint<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">282</span>\r\nKernel panic <span class=\"token operator\">-</span> not syncing<span class=\"token operator\">:</span> panic_on_warn set <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\r\n\r\nCPU<span class=\"token operator\">:</span> <span class=\"token number\">1</span> PID<span class=\"token operator\">:</span> <span class=\"token number\">19167</span> Comm<span class=\"token operator\">:</span> syz<span class=\"token operator\">-</span>executor6 Not tainted <span class=\"token number\">4.16</span><span class=\"token number\">.0</span><span class=\"token operator\">-</span>rc5<span class=\"token operator\">+</span> #<span class=\"token number\">12</span>\r\nHardware name<span class=\"token operator\">:</span> QEMU Standard <span class=\"token function\">PC</span> <span class=\"token punctuation\">(</span>i440FX <span class=\"token operator\">+</span> PIIX<span class=\"token punctuation\">,</span> <span class=\"token number\">1996</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> BIOS <span class=\"token number\">1.10</span><span class=\"token number\">.2</span><span class=\"token operator\">-</span><span class=\"token number\">1u</span>buntu1 <span class=\"token number\">04</span><span class=\"token operator\">/</span><span class=\"token number\">01</span><span class=\"token operator\">/</span><span class=\"token number\">2014</span>\r\nCall Trace<span class=\"token operator\">:</span>\r\n __dump_stack lib<span class=\"token operator\">/</span>dump_stack<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">17</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">inline</span><span class=\"token punctuation\">]</span>\r\n dump_stack<span class=\"token operator\">+</span><span class=\"token number\">0xb9</span><span class=\"token operator\">/</span><span class=\"token number\">0x11b</span> lib<span class=\"token operator\">/</span>dump_stack<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">53</span>\r\n panic<span class=\"token operator\">+</span><span class=\"token number\">0x10a</span><span class=\"token operator\">/</span><span class=\"token number\">0x2d6</span> kernel<span class=\"token operator\">/</span>panic<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">183</span>\r\n __warn<span class=\"token punctuation\">.</span>cold<span class=\"token punctuation\">.</span><span class=\"token number\">6</span><span class=\"token operator\">+</span><span class=\"token number\">0x108</span><span class=\"token operator\">/</span><span class=\"token number\">0x10f</span> kernel<span class=\"token operator\">/</span>panic<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">547</span>\r\nDumping ftrace buffer<span class=\"token operator\">:</span>\r\n   <span class=\"token punctuation\">(</span>ftrace buffer empty<span class=\"token punctuation\">)</span>\r\nKernel Offset<span class=\"token operator\">:</span> <span class=\"token number\">0xf200000</span> from <span class=\"token number\">0xffffffff81000000</span> <span class=\"token punctuation\">(</span>relocation range<span class=\"token operator\">:</span> <span class=\"token number\">0xffffffff80000000</span><span class=\"token operator\">-</span><span class=\"token number\">0xffffffffbfffffff</span><span class=\"token punctuation\">)</span>\r\nRebooting in <span class=\"token number\">86400</span> seconds<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></code></pre></div>\n<h3 id=\"code\" style=\"position:relative;\"><a href=\"#code\" aria-label=\"code permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Code</h3>\n<p>In <em>kernel/tracepoint.c</em> at <code class=\"language-text\">282 line</code>,</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">int</span> <span class=\"token function\">tracepoint_probe_register_prio</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">struct</span> <span class=\"token class-name\">tracepoint</span> <span class=\"token operator\">*</span>tp<span class=\"token punctuation\">,</span> <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>probe<span class=\"token punctuation\">,</span>\r\n\t\t\t\t   <span class=\"token keyword\">void</span> <span class=\"token operator\">*</span>data<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> prio<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n\t<span class=\"token keyword\">struct</span> <span class=\"token class-name\">tracepoint_func</span> tp_func<span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">int</span> ret<span class=\"token punctuation\">;</span>\r\n\r\n\t<span class=\"token function\">mutex_lock</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>tracepoints_mutex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\ttp_func<span class=\"token punctuation\">.</span>func <span class=\"token operator\">=</span> probe<span class=\"token punctuation\">;</span>\r\n\ttp_func<span class=\"token punctuation\">.</span>data <span class=\"token operator\">=</span> data<span class=\"token punctuation\">;</span>\r\n\ttp_func<span class=\"token punctuation\">.</span>prio <span class=\"token operator\">=</span> prio<span class=\"token punctuation\">;</span>\r\n\tret <span class=\"token operator\">=</span> <span class=\"token function\">tracepoint_add_func</span><span class=\"token punctuation\">(</span>tp<span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>tp_func<span class=\"token punctuation\">,</span> prio<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// line 282</span>\r\n\t<span class=\"token function\">mutex_unlock</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>tracepoints_mutex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">return</span> ret<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token keyword\">static</span> <span class=\"token keyword\">int</span> <span class=\"token function\">tracepoint_add_func</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">struct</span> <span class=\"token class-name\">tracepoint</span> <span class=\"token operator\">*</span>tp<span class=\"token punctuation\">,</span>\r\n\t\t\t       <span class=\"token keyword\">struct</span> <span class=\"token class-name\">tracepoint_func</span> <span class=\"token operator\">*</span>func<span class=\"token punctuation\">,</span> <span class=\"token keyword\">int</span> prio<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n\t<span class=\"token keyword\">struct</span> <span class=\"token class-name\">tracepoint_func</span> <span class=\"token operator\">*</span>old<span class=\"token punctuation\">,</span> <span class=\"token operator\">*</span>tp_funcs<span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">int</span> ret<span class=\"token punctuation\">;</span>\r\n\r\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>tp<span class=\"token operator\">-></span>regfunc <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">!</span><span class=\"token function\">static_key_enabled</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>tp<span class=\"token operator\">-></span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n\t\tret <span class=\"token operator\">=</span> tp<span class=\"token operator\">-></span><span class=\"token function\">regfunc</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>ret <span class=\"token operator\">&lt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\r\n\t\t\t<span class=\"token keyword\">return</span> ret<span class=\"token punctuation\">;</span>\r\n\t<span class=\"token punctuation\">}</span>\r\n\r\n\ttp_funcs <span class=\"token operator\">=</span> <span class=\"token function\">rcu_dereference_protected</span><span class=\"token punctuation\">(</span>tp<span class=\"token operator\">-></span>funcs<span class=\"token punctuation\">,</span>\r\n\t\t\t<span class=\"token function\">lockdep_is_held</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>tracepoints_mutex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\told <span class=\"token operator\">=</span> <span class=\"token function\">func_add</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>tp_funcs<span class=\"token punctuation\">,</span> func<span class=\"token punctuation\">,</span> prio<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">IS_ERR</span><span class=\"token punctuation\">(</span>old<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n\t\t<span class=\"token function\">WARN_ON_ONCE</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">PTR_ERR</span><span class=\"token punctuation\">(</span>old<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token punctuation\">}</span>\r\n\r\n\t<span class=\"token comment\">/*\r\n\t * rcu_assign_pointer has as smp_store_release() which makes sure\r\n\t * that the new probe callbacks array is consistent before setting\r\n\t * a pointer to it.  This array is referenced by __DO_TRACE from\r\n\t * include/linux/tracepoint.h using rcu_dereference_sched().\r\n\t */</span>\r\n\t<span class=\"token function\">rcu_assign_pointer</span><span class=\"token punctuation\">(</span>tp<span class=\"token operator\">-></span>funcs<span class=\"token punctuation\">,</span> tp_funcs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">static_key_enabled</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>tp<span class=\"token operator\">-></span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\t\t<span class=\"token function\">static_key_slow_inc</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>tp<span class=\"token operator\">-></span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">release_probes</span><span class=\"token punctuation\">(</span>old<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>From the <em>tracepoint_add_func</em>, there's a line that like this...</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\r\n\ttp_funcs <span class=\"token operator\">=</span> <span class=\"token function\">rcu_dereference_protected</span><span class=\"token punctuation\">(</span>tp<span class=\"token operator\">-></span>funcs<span class=\"token punctuation\">,</span>\r\n\t\t\t<span class=\"token function\">lockdep_is_held</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>tracepoints_mutex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\told <span class=\"token operator\">=</span> <span class=\"token function\">func_add</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>tp_funcs<span class=\"token punctuation\">,</span> func<span class=\"token punctuation\">,</span> prio<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">IS_ERR</span><span class=\"token punctuation\">(</span>old<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n\t\t<span class=\"token function\">WARN_ON_ONCE</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// &lt;- here</span>\r\n\t\t<span class=\"token keyword\">return</span> <span class=\"token function\">PTR_ERR</span><span class=\"token punctuation\">(</span>old<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token punctuation\">}</span>\r\n\t<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></code></pre></div>\n<p>So the warning just happened... nothing more than else :)</p>\n<h3 id=\"poc-1\" style=\"position:relative;\"><a href=\"#poc-1\" aria-label=\"poc 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PoC</h3>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name\">_GNU_SOURCE</span> </span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;endian.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sys/syscall.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;unistd.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;errno.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;fcntl.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdarg.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdbool.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdio.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;sys/stat.h></span></span>\r\n\r\n<span class=\"token keyword\">__attribute__</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>noreturn<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">doexit</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> status<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n\t<span class=\"token keyword\">volatile</span> <span class=\"token keyword\">unsigned</span> i<span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">syscall</span><span class=\"token punctuation\">(</span>__NR_exit_group<span class=\"token punctuation\">,</span> status<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span>i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;stdint.h></span></span>\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;string.h></span></span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token keyword\">int</span> kFailStatus <span class=\"token operator\">=</span> <span class=\"token number\">67</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token keyword\">int</span> kRetryStatus <span class=\"token operator\">=</span> <span class=\"token number\">69</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">exitf</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> msg<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n\t<span class=\"token keyword\">int</span> e <span class=\"token operator\">=</span> errno<span class=\"token punctuation\">;</span>\r\n\tva_list args<span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">va_start</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">,</span> msg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">vfprintf</span><span class=\"token punctuation\">(</span><span class=\"token constant\">stderr</span><span class=\"token punctuation\">,</span> msg<span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">va_end</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">fprintf</span><span class=\"token punctuation\">(</span><span class=\"token constant\">stderr</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\" (errno %d)\\n\"</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">doexit</span><span class=\"token punctuation\">(</span>kRetryStatus<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">BITMASK_LEN</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">,</span>bf_len<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">1ull</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token punctuation\">(</span>bf_len<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span></span></span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">BITMASK_LEN_OFF</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">,</span>bf_off<span class=\"token punctuation\">,</span>bf_len<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token function\">BITMASK_LEN</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>bf_len<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token punctuation\">(</span>bf_off<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></span></span>\r\n\r\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">define</span> <span class=\"token macro-name function\">STORE_BY_BITMASK</span><span class=\"token expression\"><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">,</span>addr<span class=\"token punctuation\">,</span>val<span class=\"token punctuation\">,</span>bf_off<span class=\"token punctuation\">,</span>bf_len<span class=\"token punctuation\">)</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>bf_off<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>bf_len<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>type<span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>val<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span> type new_val <span class=\"token operator\">=</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>type<span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> new_val <span class=\"token operator\">&amp;=</span> <span class=\"token operator\">~</span><span class=\"token function\">BITMASK_LEN_OFF</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>bf_off<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>bf_len<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> new_val <span class=\"token operator\">|=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>val<span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token function\">BITMASK_LEN</span><span class=\"token punctuation\">(</span>type<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>bf_len<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;&lt;</span> <span class=\"token punctuation\">(</span>bf_off<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span>type<span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>addr<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> new_val<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span></span></span>\r\n\r\n<span class=\"token keyword\">static</span> bool <span class=\"token function\">write_file</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> file<span class=\"token punctuation\">,</span> <span class=\"token keyword\">const</span> <span class=\"token keyword\">char</span><span class=\"token operator\">*</span> what<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n\t<span class=\"token keyword\">char</span> buf<span class=\"token punctuation\">[</span><span class=\"token number\">1024</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\tva_list args<span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">va_start</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">,</span> what<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">vsnprintf</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">,</span> <span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> what<span class=\"token punctuation\">,</span> args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">va_end</span><span class=\"token punctuation\">(</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\tbuf<span class=\"token punctuation\">[</span><span class=\"token keyword\">sizeof</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">int</span> len <span class=\"token operator\">=</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n\t<span class=\"token keyword\">int</span> fd <span class=\"token operator\">=</span> <span class=\"token function\">open</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">,</span> O_WRONLY <span class=\"token operator\">|</span> O_CLOEXEC<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>fd <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\r\n\t\t<span class=\"token keyword\">return</span> false<span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>fd<span class=\"token punctuation\">,</span> buf<span class=\"token punctuation\">,</span> len<span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> len<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n\t\t<span class=\"token function\">close</span><span class=\"token punctuation\">(</span>fd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t\t<span class=\"token keyword\">return</span> false<span class=\"token punctuation\">;</span>\r\n\t<span class=\"token punctuation\">}</span>\r\n\t<span class=\"token function\">close</span><span class=\"token punctuation\">(</span>fd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">return</span> true<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">static</span> <span class=\"token keyword\">int</span> <span class=\"token function\">inject_fault</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> nth<span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n\t<span class=\"token keyword\">int</span> fd<span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">char</span> buf<span class=\"token punctuation\">[</span><span class=\"token number\">16</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\r\n\r\n\tfd <span class=\"token operator\">=</span> <span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/proc/thread-self/fail-nth\"</span><span class=\"token punctuation\">,</span> O_RDWR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>fd <span class=\"token operator\">==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\r\n\t\t<span class=\"token function\">exitf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"failed to open /proc/thread-self/fail-nth\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">sprintf</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">,</span> <span class=\"token string\">\"%d\"</span><span class=\"token punctuation\">,</span> nth <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>fd<span class=\"token punctuation\">,</span> buf<span class=\"token punctuation\">,</span> <span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">ssize_t</span><span class=\"token punctuation\">)</span><span class=\"token function\">strlen</span><span class=\"token punctuation\">(</span>buf<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\t\t<span class=\"token function\">exitf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"failed to write /proc/thread-self/fail-nth\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">return</span> fd<span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">void</span> <span class=\"token function\">loop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x200000c0</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">syscall</span><span class=\"token punctuation\">(</span>__NR_set_mempolicy<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200000c0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1f</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x20000180</span> <span class=\"token operator\">=</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x20000184</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x78</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint8_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x20000188</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x2d</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint8_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x20000189</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint8_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x2000018a</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint8_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x2000018b</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x2000018c</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x20000190</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x20000198</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x3e4</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x200001a0</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    \r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">6</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">9</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">13</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">14</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">17</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">18</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">19</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">21</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">22</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">24</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">25</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">26</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">27</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">28</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token function\">STORE_BY_BITMASK</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x200001a8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">29</span><span class=\"token punctuation\">,</span> <span class=\"token number\">35</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x200001b0</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x200001b4</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x200001b8</span> <span class=\"token operator\">=</span> <span class=\"token number\">0x20000100</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x200001c0</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x200001c8</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x200001d0</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x200001d8</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x200001e0</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint64_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x200001e8</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint32_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x200001f0</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint16_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x200001f4</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token operator\">*</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">uint16_t</span><span class=\"token operator\">*</span><span class=\"token punctuation\">)</span><span class=\"token number\">0x200001f6</span> <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n    \r\n    <span class=\"token function\">write_file</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/sys/kernel/debug/failslab/ignore-gfp-wait\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"N\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">write_file</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/sys/kernel/debug/fail_futex/ignore-private\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"N\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">inject_fault</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">syscall</span><span class=\"token punctuation\">(</span>__NR_perf_event_open<span class=\"token punctuation\">,</span> <span class=\"token number\">0x20000180</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">{</span>\r\n\t<span class=\"token function\">syscall</span><span class=\"token punctuation\">(</span>__NR_mmap<span class=\"token punctuation\">,</span> <span class=\"token number\">0x20000000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1000000</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x32</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token function\">loop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t<span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token punctuation\">}</span>\r\n</code></pre></div>\n<p><strong>End</strong></p>\n<h2 id=\"tty_set_ldisc---warn\" style=\"position:relative;\"><a href=\"#tty_set_ldisc---warn\" aria-label=\"tty_set_ldisc   warn permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>tty_set_ldisc - warn</h2>\n<p>Got from syzkaller &#x26; Found in <em>LK v4.16.0-rc5</em> with enabling <code class=\"language-text\">CONFIG_FAULT_INJECTION</code>.</p>\n<h3 id=\"call-trace-dump-3\" style=\"position:relative;\"><a href=\"#call-trace-dump-3\" aria-label=\"call trace dump 3 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Call Trace (Dump)</h3>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\">WARNING<span class=\"token operator\">:</span> CPU<span class=\"token operator\">:</span> <span class=\"token number\">0</span> PID<span class=\"token operator\">:</span> <span class=\"token number\">2567</span> at drivers<span class=\"token operator\">/</span>tty<span class=\"token operator\">/</span>tty_ldisc<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">531</span> tty_ldisc_restore drivers<span class=\"token operator\">/</span>tty<span class=\"token operator\">/</span>tty_ldisc<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">531</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">inline</span><span class=\"token punctuation\">]</span>\r\nWARNING<span class=\"token operator\">:</span> CPU<span class=\"token operator\">:</span> <span class=\"token number\">0</span> PID<span class=\"token operator\">:</span> <span class=\"token number\">2567</span> at drivers<span class=\"token operator\">/</span>tty<span class=\"token operator\">/</span>tty_ldisc<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">531</span> tty_set_ldisc<span class=\"token operator\">+</span><span class=\"token number\">0x1d6</span><span class=\"token operator\">/</span><span class=\"token number\">0x2c0</span> drivers<span class=\"token operator\">/</span>tty<span class=\"token operator\">/</span>tty_ldisc<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">599</span>\r\nKernel panic <span class=\"token operator\">-</span> not syncing<span class=\"token operator\">:</span> panic_on_warn set <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\r\n\r\nCPU<span class=\"token operator\">:</span> <span class=\"token number\">0</span> PID<span class=\"token operator\">:</span> <span class=\"token number\">2567</span> Comm<span class=\"token operator\">:</span> syz<span class=\"token operator\">-</span>executor0 Not tainted <span class=\"token number\">4.16</span><span class=\"token number\">.0</span><span class=\"token operator\">-</span>rc5<span class=\"token operator\">+</span> #<span class=\"token number\">12</span>\r\nHardware name<span class=\"token operator\">:</span> QEMU Standard <span class=\"token function\">PC</span> <span class=\"token punctuation\">(</span>i440FX <span class=\"token operator\">+</span> PIIX<span class=\"token punctuation\">,</span> <span class=\"token number\">1996</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> BIOS <span class=\"token number\">1.10</span><span class=\"token number\">.2</span><span class=\"token operator\">-</span><span class=\"token number\">1u</span>buntu1 <span class=\"token number\">04</span><span class=\"token operator\">/</span><span class=\"token number\">01</span><span class=\"token operator\">/</span><span class=\"token number\">2014</span>\r\nCall Trace<span class=\"token operator\">:</span>\r\n __dump_stack lib<span class=\"token operator\">/</span>dump_stack<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">17</span> <span class=\"token punctuation\">[</span><span class=\"token keyword\">inline</span><span class=\"token punctuation\">]</span>\r\n dump_stack<span class=\"token operator\">+</span><span class=\"token number\">0xb9</span><span class=\"token operator\">/</span><span class=\"token number\">0x11b</span> lib<span class=\"token operator\">/</span>dump_stack<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">53</span>\r\n panic<span class=\"token operator\">+</span><span class=\"token number\">0x10a</span><span class=\"token operator\">/</span><span class=\"token number\">0x2d6</span> kernel<span class=\"token operator\">/</span>panic<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">183</span>\r\n __warn<span class=\"token punctuation\">.</span>cold<span class=\"token punctuation\">.</span><span class=\"token number\">6</span><span class=\"token operator\">+</span><span class=\"token number\">0x108</span><span class=\"token operator\">/</span><span class=\"token number\">0x10f</span> kernel<span class=\"token operator\">/</span>panic<span class=\"token punctuation\">.</span>c<span class=\"token operator\">:</span><span class=\"token number\">547</span>\r\nDumping ftrace buffer<span class=\"token operator\">:</span>\r\n   <span class=\"token punctuation\">(</span>ftrace buffer empty<span class=\"token punctuation\">)</span>\r\nKernel Offset<span class=\"token operator\">:</span> <span class=\"token number\">0x26e00000</span> from <span class=\"token number\">0xffffffff81000000</span> <span class=\"token punctuation\">(</span>relocation range<span class=\"token operator\">:</span> <span class=\"token number\">0xffffffff80000000</span><span class=\"token operator\">-</span><span class=\"token number\">0xffffffffbfffffff</span><span class=\"token punctuation\">)</span>\r\nRebooting in <span class=\"token number\">86400</span> seconds<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></code></pre></div>\n<h3 id=\"poc-2\" style=\"position:relative;\"><a href=\"#poc-2\" aria-label=\"poc 2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PoC</h3>\n<p>There's no reproducible code from syz-repro, but repro-log.</p>\n<div class=\"gatsby-highlight\" data-language=\"c\"><pre class=\"language-c\"><code class=\"language-c\"># <span class=\"token punctuation\">{</span>Threaded<span class=\"token operator\">:</span>true Collide<span class=\"token operator\">:</span>false Repeat<span class=\"token operator\">:</span>false Procs<span class=\"token operator\">:</span><span class=\"token number\">1</span> Sandbox<span class=\"token operator\">:</span>setuid Fault<span class=\"token operator\">:</span>true FaultCall<span class=\"token operator\">:</span><span class=\"token number\">5</span> FaultNth<span class=\"token operator\">:</span><span class=\"token number\">1</span> EnableTun<span class=\"token operator\">:</span>true UseTmpDir<span class=\"token operator\">:</span>true HandleSegv<span class=\"token operator\">:</span>true WaitRepeat<span class=\"token operator\">:</span>false Debug<span class=\"token operator\">:</span>false Repro<span class=\"token operator\">:</span>false<span class=\"token punctuation\">}</span>\r\nr0 <span class=\"token operator\">=</span> openat$<span class=\"token function\">ptmx</span><span class=\"token punctuation\">(</span><span class=\"token number\">0xffffffffffffff9c</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x7f0000000180</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token string\">'/dev/ptmx\\x00'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x0</span><span class=\"token punctuation\">)</span>\r\nioctl$<span class=\"token function\">TCXONC</span><span class=\"token punctuation\">(</span>r0<span class=\"token punctuation\">,</span> <span class=\"token number\">0x40045431</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x6f7000</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token function\">poll</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x7f0000000080</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>r0<span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0x80000000</span><span class=\"token punctuation\">)</span>\r\nioctl$<span class=\"token function\">TIOCPKT</span><span class=\"token punctuation\">(</span>r0<span class=\"token punctuation\">,</span> <span class=\"token number\">0x5420</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x7f0000000040</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">0x7</span><span class=\"token punctuation\">)</span>\r\nr1 <span class=\"token operator\">=</span> <span class=\"token function\">syz_open_pts</span><span class=\"token punctuation\">(</span>r0<span class=\"token punctuation\">,</span> <span class=\"token number\">0x0</span><span class=\"token punctuation\">)</span>\r\nioctl$<span class=\"token function\">TIOCSETD</span><span class=\"token punctuation\">(</span>r1<span class=\"token punctuation\">,</span> <span class=\"token number\">0x5423</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span><span class=\"token punctuation\">(</span><span class=\"token number\">0x7f0000000000</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">0x2</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>End</strong></p>","excerpt":"sctp_id2assoc - use after free Read Found in LK v4.16.0-rc4. Maybe it could be useful :) Call Trace (Dump) End init_tty - kernel panic Got ","tableOfContents":"<ul>\n<li>\n<p><a href=\"#sctp_id2assoc---use-after-free-read\">sctp_id2assoc - use after free Read</a></p>\n<ul>\n<li><a href=\"#call-trace-dump\">Call Trace (Dump)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#init_tty---kernel-panic\">init_tty - kernel panic</a></p>\n<ul>\n<li><a href=\"#call-trace-dump-1\">Call Trace (Dump)</a></li>\n<li><a href=\"#poc\">PoC</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#tracepoint_probe_register_prio---warn\">tracepoint_probe_register_prio - warn</a></p>\n<ul>\n<li><a href=\"#call-trace-dump-2\">Call Trace (Dump)</a></li>\n<li><a href=\"#code\">Code</a></li>\n<li><a href=\"#poc-1\">PoC</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#tty_set_ldisc---warn\">tty_set_ldisc - warn</a></p>\n<ul>\n<li><a href=\"#call-trace-dump-3\">Call Trace (Dump)</a></li>\n<li><a href=\"#poc-2\">PoC</a></li>\n</ul>\n</li>\n</ul>","fields":{"slug":"/2018-03-2-Founds/"},"frontmatter":{"title":"Linux Kernel - 2018-03-2 Founds","date":"Mar 11, 2018","tags":["Security","Linux-Kernel"],"keywords":["0-day","Bug"],"update":"Mar 13, 2018"},"timeToRead":16}},"pageContext":{"slug":"/2018-03-2-Founds/","series":[],"lastmod":"2018-03-13"}},
    "staticQueryHashes": ["2027115977","2744905544","694178885"]}