{"componentChunkName":"component---src-templates-post-tsx","path":"/VFNet/","result":{"data":{"markdownRemark":{"html":"<h2 id=\"tldr\" style=\"position:relative;\"><a href=\"#tldr\" aria-label=\"tldr permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>TL;DR</h2>\n<p>최근에 Object Detection (이하 OD) task 관련 kaggle challenge를 하다, 비슷한 대회 solutions들을 보다가 상위 랭크 solution에 <code class=\"language-text\">VertiFocalNet</code> (이하 <code class=\"language-text\">VFNet</code>)을 사용한 걸 발견해서, 요 논문을 더 자세하게 공부해 보고 싶어서 정리해 봅니다.</p>\n<p>OD 쪽을 오랜만에 공부해 보니 그동안 공부 안 했던 스택이 쌓였는지, 볼 것도 많지만 대회에도 써 보면서 재밌게 공부했습니다.</p>\n<ul>\n<li><code class=\"language-text\">VertiFocalNet</code> papepr : <a href=\"https://arxiv.org/pdf/2008.13367.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">arXiv</a></li>\n<li><code class=\"language-text\">VertiFocalNet</code> official repo : <a href=\"https://github.com/hyz-xmaster/VarifocalNet\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">github</a></li>\n</ul>\n<h2 id=\"related-work\" style=\"position:relative;\"><a href=\"#related-work\" aria-label=\"related work permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Related Work</h2>\n<p>논문에서 제시하는 novelty들에 직/간접적으로 영향을 주거나 관련있는 논문들.</p>\n<ul>\n<li>Deformable Convolution : <a href=\"https://arxiv.org/abs/1703.06211\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">arXiv</a></li>\n<li>FCOS : <a href=\"https://arxiv.org/abs/1904.01355\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">arXiv</a></li>\n<li>ATSS : <a href=\"https://arxiv.org/abs/1912.02424\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">arXiv</a></li>\n<li>FocalLoss : <a href=\"https://arxiv.org/abs/1708.02002\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">arXiv</a></li>\n</ul>\n<h2 id=\"introduction\" style=\"position:relative;\"><a href=\"#introduction\" aria-label=\"introduction permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Introduction</h2>\n<p>OD task에서 높은 성능을 얻으려면 candidate detection를 rank 하는 게 중요한 것 중 하나인데, 이전 연구들은 classification or localization score 등을 candidates를 rank 하는데 사용해 <strong>reliable 하지 못하다</strong>는 점을 짚으며, 요걸 joint learn 할 수 있는 reliable 한 method, IACS (IoU-Aware Classification Score)를 제안합니다.</p>\n<p>이 논문에서 제시하는 novelty는 크게 3가지입니다.</p>\n<ol>\n<li>IACS (IoU-Aware Classification Score)</li>\n<li>VertiFocal Loss</li>\n<li>Star-Shaped Box Feature Representation</li>\n</ol>\n<h2 id=\"architecture\" style=\"position:relative;\"><a href=\"#architecture\" aria-label=\"architecture permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Architecture</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 559px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/828cd589f041ffe24557ef2461b85b17/a65ce/vertifocal_loss.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 127.02702702702702%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAZCAIAAAC+dZmEAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEw0lEQVR42l1TaVMbRxTU705VqvzNiZ2QxC7bYGIjDAYMlo0ACdCBELpZCXTsOdfOzN7aXXFIEMBBm1ocuyrpj1PT/fp110vImpLNvi5u/lbMrBQya9nVmWxqdmdtvpB9ls5+3smmvKEbRdHV1dVkMomiyPf9IAiiByQU2C3k3zVyyb3Sdjaf3U1t7RTSu9nVfGY5X9k7LG+PQmc6jcIg8IPR8OLOD8LRaPQvmdi92vFyq7VarH+qVNa3l5ar9fV2e0UQ1g6EzPZ+8uzSnUyuLdPwgxHzr71hcPadjIyTw+pCo7GSr34qNtPru5mDysaxsNpsLucb6ZqUHu6tXJwcT+6+jC8v/m+b8NNKJdmur6TLm9vC0dbxyau97GE3124tF5rp8skaz7y75nSgqv1uV5RlURQHA3E6ncZkaJyUq7NtYSG1t7pXKuWKO7/MzWztb7SFZK6xVagkR+d2FEWT8fji/DyKpsOh5w/977ZPK7U/Dj4//ZRaTm6nllI/zS7MFHfflDK/LqUWdpvz5lA7uz63fcv3w+HFHTdM143zn0ZRAhudcu1tubCYr6fWMhs/PC//+PJoYzvVOlrKlDdywhviScNJwF3meoEZ3uiUO44Tk6fTBODCwdFs8/hdrrq6k1969Hj+yY9PHj1eLB6kyp200Pt4fuk89DwZj8dRFAVBEIbht8Cs03Ij2agv7VfWW9LGz8/m55Jz+/sbWB4Umh+POov+iI3HV+220G53zs7O+71ep9MZjc7iydjs1ZovmqWZfHm9013d2lzIF19hedMluXqvHITctDCCCAAAESIxMKUMYzweTxKQt49aLxu1F3uFpUY9nf2QKh2+rpVS5cL6QSMnSXUIB/2eKMvK6Wl3fDm+u729vr6+vb29v79PMEuqdlK17vqBsFJqHO2WM8XWRqH1MZV+n8kvHrYWEO56ruv7rq5jGQDHDzzf93xvPBknMG9X2h+EQbYqfHj//vf1raeZ4vOd4vN8ba7UfHtQ/xMRzfNuHOeCEMcXxb8978vFpYPdy9FlIjzjutkxPNkNGLMkzDrEOEXshPAud/q23w/C0PNuXGcShH/dh2Hkujfh6Ny5vJ3cJizLpjob+nEBhFCCiU4oo9y2HNOwTNMGEOkEOY5FCEK6Tk1L5xRA4DhOwuBckkRVVRHCGGMINE0DotjnhoHjJyTJcq/Xk0QJQmjbNtV1jLEoioyxBOeMcwNqGtUppRQAqGkaQogyxjhDEAiCAB+EKWUgBtR1QqgeT/ZcV5YVxpiiqpxzAADGSBQlwzBQDOx5LgBAFEVd1799wJoGwnCUMAyDc051XVFiMuM8CHwAgE7IYDAwDdPzvFazXqlWT05Oj1stFlsyIARD30/E7jiLfVIKIYIQMkYVRSFEt20bQaSqmsGZrlOMkE4ZIcS0LIKxH4Txzv1+HyEky7KqqpIsfxWSJEnXqaYqkiwriqKoKmMUIoQgHAwGGCPHcROGwQkhqqogTBilvX5flmUAoCQOAEScM1VVNU2TlVgCAGBZlqoooiiZlhVXxTlXFQVjoqmqrCi243AeBwsh1HUdQahq4GtDsfMH2Lbtum7CcRzO4k0c2yZEt0yTc44xNk2TUuo4DoSAUjb9L77e8z9+fuiNQFppHQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"vertifocal_loss\"\n        title=\"vertifocal_loss\"\n        src=\"/static/828cd589f041ffe24557ef2461b85b17/a65ce/vertifocal_loss.png\"\n        srcset=\"/static/828cd589f041ffe24557ef2461b85b17/12f09/vertifocal_loss.png 148w,\n/static/828cd589f041ffe24557ef2461b85b17/e4a3f/vertifocal_loss.png 295w,\n/static/828cd589f041ffe24557ef2461b85b17/a65ce/vertifocal_loss.png 559w\"\n        sizes=\"(max-width: 559px) 100vw, 559px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3 id=\"iacs-iou-aware-classification-score\" style=\"position:relative;\"><a href=\"#iacs-iou-aware-classification-score\" aria-label=\"iacs iou aware classification score permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>IACS (IoU-Aware Classification Score)</h3>\n<p><code class=\"language-text\">IACS</code>는 classificaiton score vector 인데, 각 값들은 gt and predicted bbox 의 IoU 값이 됩니다. 위에 첨부한 <code class=\"language-text\">Figure 1</code> 과 같습니다.</p>\n<h3 id=\"vertifocal-loss\" style=\"position:relative;\"><a href=\"#vertifocal-loss\" aria-label=\"vertifocal loss permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>VertiFocal Loss</h3>\n<p><code class=\"language-text\">IACS</code>를 탐지하기 위해 <code class=\"language-text\">VertiFocal Loss</code>를 설계했는데, idea는 <code class=\"language-text\">Focal Loss</code>에서 가져왔습니다. 이유는 IACS를 regress할 때 imbalance 문제를 해결하기 위해서라고 합니다.</p>\n<blockquote>\n<p><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mi>F</mi><mi>L</mi><mo stretchy=\"false\">(</mo><mi>p</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mi>q</mi><mo stretchy=\"false\">(</mo><mi>q</mi><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=\"false\">(</mo><mi>p</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mi>q</mi><mo stretchy=\"false\">)</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>q</mi><mo>></mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">VFL(p, y) = -q(qlog(p) + (1 - q)log(1 - p)), q > 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">ql</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">))</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></span></p>\n<p><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>V</mi><mi>F</mi><mi>L</mi><mo stretchy=\"false\">(</mo><mi>p</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mi>α</mi><msup><mi>p</mi><mi>γ</mi></msup><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mi>q</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">VFL(p, y) = -\\alpha p^{\\gamma}(1 - p), q = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mord mathnormal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">−</span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05556em;\">γ</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></span></p>\n</blockquote>\n<p><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi></mrow><annotation encoding=\"application/x-tex\">p</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span></span></span></span></span> = predicted IACS, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span> = target score</p>\n<p>fg (foreground)일 때는, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span> = gt 와 generated bbox 의 IoU\nbg (background)일 때는, 모든 classes에 대해 target <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span> = 0</p>\n<p>논문에서 bg 일 때 (<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span> = 0)는 negative examples에 대해서<strong>만</strong> factor (<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>p</mi><mi>γ</mi></msup></mrow><annotation encoding=\"application/x-tex\">p^{\\gamma}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8588em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">p</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.05556em;\">γ</span></span></span></span></span></span></span></span></span></span></span></span></span>)로 scale 하는 이유는, positive exmaples (<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span> > 0)에선 negative exmaples에 비해 rare 하게 등장하기 때문에 scale 하지 않았다고 합니다. 그리고 <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi></mrow><annotation encoding=\"application/x-tex\">q</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span></span></span></span></span> = 0일 때, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>α</mi></mrow><annotation encoding=\"application/x-tex\">\\alpha</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span></span></span></span></span>를 scale 해 positive, negative losses 사이에 balance를 잡아줬다고 합니다.</p>\n<h3 id=\"star-shaped-box-feature-representation\" style=\"position:relative;\"><a href=\"#star-shaped-box-feature-representation\" aria-label=\"star shaped box feature representation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Star-Shaped Box Feature Representation</h3>\n<p><code class=\"language-text\">IACS</code>를 에측하기 위해서 Star-shaped Box Feature Representaion을 개발했다는데, 요약하면 deformable convolution\n로 9 개의 bbox points (= <code class=\"language-text\">Figure 1</code>에 노란 점들)를 표현하는 무언가다.</p>\n<p>구체적인 과정은,</p>\n<ol>\n<li>initial bbox, 4 points (x1, y1, x2, y2)를 fixed kernel size의 3x3 convolution으로 찾는다.</li>\n<li>By <code class=\"language-text\">FCOS</code>, points들이 4d-vector로 encoded됨. (<span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>l</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">l'</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span></span>, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>t</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">t'</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span></span>, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>r</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">r'</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span></span>, <span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>b</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">b'</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span></span>).\n<ul>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>l</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">l'</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span></span> : distance from sample location (x, y) to left side of the bbox.</li>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>t</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">t'</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span></span> : distance from sample location (x, y) to top side of the bbox.</li>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>r</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">r'</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span></span> : distance from sample location (x, y) to right side of the bbox.</li>\n<li><span class=\"math math-inline\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>b</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><annotation encoding=\"application/x-tex\">b'</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7519em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span></span> : distance from sample location (x, y) to bottom side of the bbox.</li>\n</ul>\n</li>\n<li>요 것들로 9 points를 <code class=\"language-text\">Figure 1</code> 그림처럼 생성</li>\n</ol>\n<p>끝으로 추가적인 예측으로 요런 points들을 생성하지 않아 computation-efficient 라고 캅니다.</p>\n<h3 id=\"bounding-box-refinement\" style=\"position:relative;\"><a href=\"#bounding-box-refinement\" aria-label=\"bounding box refinement permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bounding Box Refinement</h3>\n<p>bbox refinement 과정도 있는데, 기존 dense od에선 비효율적이라 잘 쓰이지 않았지만, 위에 제안한 Star-shaped Box Feature Representation 덕분에 효율적으로 refine이 가능하다고 합니다.</p>\n<p>아래 이미지는 전체적인 architecture 입니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/75c12737316482145ee02fd72a41030d/fe720/architecture.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.35135135135135%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACCklEQVR42oXQyW7aUAAFUH6rX9Jt/6HKtotKXbWrqFWrbtKiSAgSIWgGCAkYM5gw2GYwOAZsP9vPE0Y1g8F4fJW76bJ3cXdHV7ophFAco6STQjv/VAAj23NmQncukgihIPCOp325gGONJken9VHVWG98z42iMPUXx2EYeWGEEOI2xttefrm3JvPm6KWBEHJPjnPcDokBQbSZXm4jULZtu+4hCP0Ey5ZzfstiUzP2UUGYvm6l8RW/AKSgMLI6q7YvS8TlHP8o9XBZPcD+FRzci3Dn+26CJ5L9qcjekZrnoosF+aabvdFeFoBagKG1Vmdcl13SPN20rZWzM2xp7B52URSHYZDg24Fy9pP++sCrtndG3b96/PyerbMSDXVuAegy/kOEw1+ZViabp7APy2ZF0v04CsLQT4VRXJsYF5hYHWnyxj7niHfM043GmWt5/VvdO9uVpR+OThD6u/12bWnHo+v5gee7ybJ32oBFkR1fS/NSHJ3Qv+P/nxTJa4UWcV1rVAbzCpQzgM4Jw5zCdKRnTsRmIj4T6wxfH3E1mq0yS4wFOCviU76qWmwKHyt3XaHYnJa6IE2T3+ja9wH2hayXmQein2tTeYLOY53sYyPz1Mri3as2le8MC3g/y/LPqZUOLQOaOlRlQQfAAIoJ5JWkGKoJBKhBU5Y0Q7cMfS1Lqq6tNGhCxZCAZtu7PwrnBHqCV3BRAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"architecture\"\n        title=\"architecture\"\n        src=\"/static/75c12737316482145ee02fd72a41030d/fcda8/architecture.png\"\n        srcset=\"/static/75c12737316482145ee02fd72a41030d/12f09/architecture.png 148w,\n/static/75c12737316482145ee02fd72a41030d/e4a3f/architecture.png 295w,\n/static/75c12737316482145ee02fd72a41030d/fcda8/architecture.png 590w,\n/static/75c12737316482145ee02fd72a41030d/efc66/architecture.png 885w,\n/static/75c12737316482145ee02fd72a41030d/c83ae/architecture.png 1180w,\n/static/75c12737316482145ee02fd72a41030d/fe720/architecture.png 1448w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"train-recipe\" style=\"position:relative;\"><a href=\"#train-recipe\" aria-label=\"train recipe permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Train Recipe</h2>\n<h3 id=\"loss\" style=\"position:relative;\"><a href=\"#loss\" aria-label=\"loss permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Loss</h3>\n<p>전체 로스는 다음과 같이 정의했는데, VFL + initial, refined bbox 둘 다 loss를 구해서 최소화 하도록 합니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 526px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3ef9e27c362c8ecc6e1d9fbb4bc032f3/2d7ab/total_loss.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABVUlEQVR42o2Qy5KkIBBF/f8vbKtKyxYRSkhABHnLRDjVdkfHLOascpE388Rtcs7HcZTjqLWG4HbnlFKcc8bYZoz3PsZ4HKWeHCf1iwahsev6ZWHWWoyx3fe+7+aZtG3LGLu1Hx/t7fG4A2dSKjRNUorvcMk5xFBKSTF2Xf96vYQQGON5xozzWmspxXsfQkgpheBTStfz5vKptW7bdu7FEMIvw59r1/wOB++MtZ/jKIS432+UUimkWldCiHMOAB6Pbp5nKSUl5PkcCCVa6+Y6JAX0w1OpFaERTxPnsGrNGKOUcs6llELAuq7GGA4gBHgfmp9W1hjnXM7Ze1//g3c4pZjLsbwWaw1CI4Dw3jvnVqVyzsYYSqnWOsaopAQArdd939/hnCJblq7vtdZt2w7DgDEGAIQQOfk8ARCMsa7r8YSt3b+1U0qcMyHl7pzW29XtP2v/q/0HOK08Ik8lDgkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"loss\"\n        title=\"loss\"\n        src=\"/static/3ef9e27c362c8ecc6e1d9fbb4bc032f3/2d7ab/total_loss.png\"\n        srcset=\"/static/3ef9e27c362c8ecc6e1d9fbb4bc032f3/12f09/total_loss.png 148w,\n/static/3ef9e27c362c8ecc6e1d9fbb4bc032f3/e4a3f/total_loss.png 295w,\n/static/3ef9e27c362c8ecc6e1d9fbb4bc032f3/2d7ab/total_loss.png 526w\"\n        sizes=\"(max-width: 526px) 100vw, 526px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"performance\" style=\"position:relative;\"><a href=\"#performance\" aria-label=\"performance permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Performance</h2>\n<h3 id=\"coco\" style=\"position:relative;\"><a href=\"#coco\" aria-label=\"coco permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>COCO</h3>\n<p>MS COCO에서 AP metric 기준 SotA 달성했다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 572px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a1b9d13879f33592f402f9d7ea27ec2f/a805e/performance.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 132.43243243243242%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAIAAAA44esqAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAD9UlEQVR42kVU23KjOhD0/39btirZBNsgBJJs3YVuSAI7jr0l2D1nigcKVTM93dM6aK0BAB/v7whhzjml13FEWutxHBlj0zRRyozRbDuS6m8xxmKMh5Lz6Xj8+voCoE8p5ZyEkI/HI+estV5vN2vtuhRr3TRNIcSc8zwna+3tdjs8n084wOPxKKW63+8hhMvl+ng8SslSymVZtNI5Ja2NMcZaG2N0zmmj13U93O83CGHTNJSyUkoI/krp9/d3zllwnnPRWpeUlFJaG+99jMF7r7VeluXgnDs2zfvHB8ZYKmWtFULM8zxNk5QyxqiUCiGYyXAhrLPee2udUirnfHi9XpcLOZ3Pzrn7/S6EQAiv67osi1KV9jRNpWRrrZkm731KKYTw38w/EPZN88ml3Gb2lLFt5qKkWJbFWruUbKZpMhU8z7P3/8Cv10twfj63zvsqj1bjOOact85qXdc63tZZa+OcS1tVI9b18P14cM66rnPehxCUVAghY6o2u9rW2lJtM1rrCs65CrG5eJBSvr29fX19Nk2jlJ7n2TmXcyaESCVTSt67OUZjjFTSORdCcM4bY6rat9sN9n1zPF6u1xDCMAzjOGhjSimCs1zKNE05zda5nc6c5hDj35l/fn6GATbH5nqlpRSMcdd1PviyFEppSrk6F6OQUiu1LVlVa5fjEIL//fH76/MT9NAYI4QghNituBBxI7zTFkJYu/tsN/9KVZtR2rZnH+K6rsF7xtjmc9HarOvNO7+U4ryvbX3IOcUYvff3+32zSoj3j484z8tSlJQAgBqQnC+XS4xRCBGD51xwztW2glprznnt/Hg8CMFvv345V63SWlPGqmdKCcF32nH7LoTwzu3rWRd+p62UPJ1OZVn2lYRwcM4xxoQQuRRjTMnJ2mkPxu6l+ZeqO2OsaZqwZQAh1LYdxpgQQikNMXDOvPf7BTBVpaadRUqpdi45tW33fD6XZUkp1WDf7gRjjBCljDEqhKj+I0QZ49uDMZmsreCllK4D9S8l78pbawkh5/NpGAYAOnIhp9Opbc89hMMACSFdB5TS/4Ofz9e6rtcLOZ5O3ns0jn0PEEIQ9pTSHvYAdBAOGCHOWdt2Su/gpbRt+3q9nLNoRE3TbJTHtj0DAPoeYEzatj2fj30P0Tiicey6VipVwXOMbdd9f38brUHXns4thAMhZBgGzjjGSEqJEMIYMVbtllJACK21Ve3r9TpAuMd1HKsy12u9ZTnnW3RVjaeQ2xU4GVOz+TfPA4SXC4GwH8cRADAMEMJ+GEfQdW3XbTlpYa0edGDTD2CMrpQaYw4YjXA/7PtuO4AQ1pm3l8uFIIzrfzvQ9z1CiGyxo5Quy/oHEPiSedSgGHcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"performance\"\n        title=\"performance\"\n        src=\"/static/a1b9d13879f33592f402f9d7ea27ec2f/a805e/performance.png\"\n        srcset=\"/static/a1b9d13879f33592f402f9d7ea27ec2f/12f09/performance.png 148w,\n/static/a1b9d13879f33592f402f9d7ea27ec2f/e4a3f/performance.png 295w,\n/static/a1b9d13879f33592f402f9d7ea27ec2f/a805e/performance.png 572w\"\n        sizes=\"(max-width: 572px) 100vw, 572px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3 id=\"vfl\" style=\"position:relative;\"><a href=\"#vfl\" aria-label=\"vfl permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>VFL</h3>\n<p>다른 dense od에 VFL를 적용해 봤을 때, 전반적으로 성능이 올라가는 점도 확인할 수 있었습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b8d766558094d9d5b4c899e183fc6f84/aec65/vfl_performance.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 101.35135135135135%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADMklEQVR42kWT2XKrOhBF8//fdc5TBogBDaBZgMxgcGJAYrJuYeee9ANVlGpXr+7e+8V7b60dhmGe5667fARBEIZVVVnnhnEchqFpagjhNI0QAiFV3/efn6f+evXev3jvt20bhyGJowSAKIriOCaEMEqnaVqWpSiKBCTOzYJzypi1NgzDpmkP8f1+9973fZfECcaIZIQxZsoyieOvry/vfdPUWuf7vud5bozZtg0A8PX9/SO+3+91VQVBAJIEAJBlmVYKANC27UOjo+h0uw1SCKX0NE1RHH3/E6/rWtd1lqZB8HE6RZQxIQRCuKqrB3aeZtk0TpQQpdQ4jtHp1Pf9L3bT1EKIBIBca8bouaohBE3TeO/rukIIb9uBoPN8XVdGqXPuF7ssCwBAEIacM4Sg1jlGuCzNtu1KyTAMx3HijEklnXMAJL+dt32vq+r9/e3z8zOOYwih4AJCWNf1uq5FfmBbaxljUspxHNM0/Z3Ze1/keRiEWZYprbIUG3M+xA/spq7SLNu2vSgKrfNlWRhj0zT9w/ZaydfX1zAMEcJJEkulsjQ15/O+74Kzj4+PeZ6F4JTSZ+fbbfgxyTzP27Zprd/e3hFEOE2Pa2m9bZu1tiyLLCPWWq21lHIYRwDAtf/fYU9ywdkpiqTSxhjBGcL4+dTWNUL4ec62vazrKjj/wfber4/SSgbH2ERrTSkRQszzvK4rZ/TP37/TZI9tS2WnKU7irut+xMuyzPPsnIMQxnGslEYIjeO4LItzzpgSImStY5QQcsyMEHo69xA/a1mWJIkTALrLJYri6yM39/u9Op8ppd57KaXSel3XFONheCzs/sCel9laK6XknF+vV/mI3rZty7Kcz2WcJNbauq7rpnFulkJ+326HuO87iJAx5tK2QghKqZTSGFPkuRDiCBnnx2+RSynzPEcIcS6kVF3XvbRtc3hDybI0ACT0UZwfJ0UYY4wgRJRSfXieSSHDMKCMZoSY8/mlu1wycuw2L4o0S7WSjPEizwGER7CNoYymaUoZy44inHMhuFL66Nw0DSEEYUwZlVIQkhFKhRAYYyHlsq7OuWmapnE8vta6+djOPM/7vv8HesRAr4OvNkEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"vfl_performance\"\n        title=\"vfl_performance\"\n        src=\"/static/b8d766558094d9d5b4c899e183fc6f84/fcda8/vfl_performance.png\"\n        srcset=\"/static/b8d766558094d9d5b4c899e183fc6f84/12f09/vfl_performance.png 148w,\n/static/b8d766558094d9d5b4c899e183fc6f84/e4a3f/vfl_performance.png 295w,\n/static/b8d766558094d9d5b4c899e183fc6f84/fcda8/vfl_performance.png 590w,\n/static/b8d766558094d9d5b4c899e183fc6f84/aec65/vfl_performance.png 687w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"conclusion\" style=\"position:relative;\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h2>\n<p>20년 기준 SotA AP를 달성했고, 제안한 VFL만 다른 구현체에 적용했을 때 promising 한 performance를 보여줘서 성능적 측면에도 좋아 보였다. 논문에서 제안한 novelty들 설계도 make sense하고 재밌게 봤다.</p>\n<p>결론 : 굳굳</p>","excerpt":"TL;DR 최근에 Object Detection (이하 OD) task 관련 kaggle challenge를 하다, 비슷한 대회 solutions들을 보다가 상위 랭크 solution에  (이하 )을 사용한 걸 발견해서, 요 논문을 더 자세하게 공부…","tableOfContents":"<ul>\n<li>\n<p><a href=\"#tldr\">TL;DR</a></p>\n</li>\n<li>\n<p><a href=\"#related-work\">Related Work</a></p>\n</li>\n<li>\n<p><a href=\"#introduction\">Introduction</a></p>\n</li>\n<li>\n<p><a href=\"#architecture\">Architecture</a></p>\n<ul>\n<li><a href=\"#iacs-iou-aware-classification-score\">IACS (IoU-Aware Classification Score)</a></li>\n<li><a href=\"#vertifocal-loss\">VertiFocal Loss</a></li>\n<li><a href=\"#star-shaped-box-feature-representation\">Star-Shaped Box Feature Representation</a></li>\n<li><a href=\"#bounding-box-refinement\">Bounding Box Refinement</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#train-recipe\">Train Recipe</a></p>\n<ul>\n<li><a href=\"#loss\">Loss</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#performance\">Performance</a></p>\n<ul>\n<li><a href=\"#coco\">COCO</a></li>\n<li><a href=\"#vfl\">VFL</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#conclusion\">Conclusion</a></p>\n</li>\n</ul>","fields":{"slug":"/VFNet/"},"frontmatter":{"title":"VertiFocalNet - An IoU-aware Dense Object Detector","date":"Jul 26, 2021","tags":["Deep-Learning"],"keywords":["object-detection","iou-aware","anchor-free"],"update":"Jul 26, 2021"},"timeToRead":2}},"pageContext":{"slug":"/VFNet/","series":[],"lastmod":"2021-07-26"}},"staticQueryHashes":["2027115977","2744905544","694178885"],"slicesMap":{}}